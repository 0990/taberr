# tabtoy

游戏客户端,服务器的策划表格数据导出

将电子表格文件根据制定proto及字段转化规则,导出为Protobuf文本格式(*.pbt)

使用者通过读取Protobuf文本格式直接获取到所有的格式化数据

# 优点

本转化器无需依赖vbs,vba.可跨平台导出

使用时无需编写任何和数据字段相关解析代码, 直接获取格式化数据

充分利用CPU多核进行导出, 是现有导出器中最快的


# 迭代历程

* 2011年: 一代导出器,基于VBA的表格内建导出器,速度慢,复用困难,容易错,不安全

* 2012年: 二代导出器,基于C++和Protobuf的导出器,内容格式与导出器混合编写,需要vbs导出csv,速度慢

* 2013年: 三代导出器,在二代基础上做到内容格式与导出器独立,但依然依赖csv前置导出,增加逗号分隔格子内容,导出速度慢

* 2015年: 四代导出器,基于Golang导出器,增加ID重复检查,数组格的多重写法, 支持a.b.c栏位导出, 导出速度大大提高

* 2016年: 五代导出器,在四代基础上重构,开源,增加转置读取,并发一次性导出,速度达到极致

# 规则

* 每个proto文件对应1个电子表格(xls,xlsm),名字统一

	例: Actor.proto 对应的电子表格名Actor.xls,最终导出文件为Actor.pbt

* 一个电子表格内的所有Sheet都是合并导出为一个pbt
	例: Actor.xls中拥有名为ActorA ActorB的Sheet,最终导出的Actor.pbt中将包含ActorA和ActorB的数据

* 没有导出头(单元格1,1)的格子不会被导出

* 第一列/行的单元格空时,终止本Sheet扫描

* \#可作为注释用，比如：屏蔽字段功能不导出

# 编译

	go get github.com/davyxu/tabtoy
	
	go install github.com/davyxu/tabtoy

# 运行
	